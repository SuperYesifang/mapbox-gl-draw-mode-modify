(()=>{"use strict";const e="Feature",t="Point",r="Multi",n="vertex",o="true",i="false";function a(e){return function(t){const r=t.featureTarget;return!!r&&!!r.properties&&r.properties.meta===e}}function c(e){return void 0===e.featureTarget}function s(e){return!!e.featureTarget&&!!e.featureTarget.properties&&"feature"===e.featureTarget.properties.meta}function l(r,a,c,s){return{type:e,properties:{meta:n,parent:r,coord_path:c,active:s?o:i},geometry:{type:t,coordinates:a}}}const p=function n(o,i={},a=null){const{type:c,coordinates:s}=o.geometry,p=o.properties&&o.properties.id;let u=[];function f(r,n){let o="",a=null;r.forEach(((r,c)=>{const s=null!=n?`${n}.${c}`:String(c),f=l(p,r,s,g(s));if(i.midpoints&&a){const r=function(r,n,o){const i=n.geometry.coordinates,a=o.geometry.coordinates;if(i[1]>85||i[1]<-85||a[1]>85||a[1]<-85)return null;const c={lng:(i[0]+a[0])/2,lat:(i[1]+a[1])/2};return{type:e,properties:{meta:"midpoint",parent:r,lng:c.lng,lat:c.lat,coord_path:o.properties.coord_path},geometry:{type:t,coordinates:[c.lng,c.lat]}}}(p,a,f);r&&u.push(r)}a=f;const d=JSON.stringify(r);o!==d&&u.push(f),0===c&&(o=d)}))}function g(e){return!!i.selectedPaths&&-1!==i.selectedPaths.indexOf(e)}return c===t?u.push(l(p,s,a,g(a))):"Polygon"===c?s.forEach(((e,t)=>{f(e,null!==a?`${a}.${t}`:String(t))})):"LineString"===c?f(s,a):0===c.indexOf(r)&&function(){const t=c.replace(r,"");s.forEach(((r,a)=>{const c={type:e,properties:o.properties,geometry:{type:t,coordinates:r}};u=u.concat(n(c,i,a))}))}(),u};function u(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?u(Object(r),!0).forEach((function(t){g(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):u(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function g(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var d={editable:!0,selectable:!0,draggable:!0,adjustable:!0,focus:!0},h=[];window.DrawModesModify=function(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(e)return r=f(f({},d),r),e.simple_select.onDrag=u,e.direct_select.onDrag=g,e.simple_select.onTap=e.simple_select.onClick=b,e.simple_select.toDisplayFeatures=l,e;function l(e,n,a){n.properties.active=this.isSelected(n.properties.id)?o:i,r.focus||-1!=h.indexOf(n.properties.id)||(n.properties.active="false",this.deselect(n.properties.id),h.push(n.properties.id)),a(n),this.fireActionable(),n.properties.active===o&&n.geometry.type!==t&&r.editable&&r.adjustable&&p(n).forEach(a)}function u(e,t){if(r.draggable)return e.canDragMove?this.dragMove(e,t):this.drawConfig.boxSelect&&e.canBoxSelect?this.whileBoxSelect(e,t):void 0}function g(e,t){if((r.draggable||e.selectedCoordPaths.length||-1===h.indexOf(e.featureId))&&e.canDragMove){e.dragMoving=!0,t.originalEvent.stopPropagation();var n={lng:t.lngLat.lng-e.dragMoveLocation.lng,lat:t.lngLat.lat-e.dragMoveLocation.lat};e.selectedCoordPaths.length>0?this.dragVertex(e,t,n):this.dragFeature(e,t,n),e.dragMoveLocation=t.lngLat}}function b(e,t){if(!r.selectable||c(t))return this.clickAnywhere(e);if(r.editable&&r.adjustable&&a(n)(t))return this.clickOnVertex(e,t);if(r.selectable){if(!r.adjustable&&this.isSelected(t.featureTarget.properties.id))return;s(t)&&this.clickOnFeature(e,t)}}}})();